<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>TENET Form</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    

<style>
    input {
        border-radius: 25px;
        font-size:30pt;
    }
    input:focus {
        outline: none;
    }

    button {
        border-radius: 25px;
        background-color: #B80F0A;
        color: white;
        padding: 15px 25px;
        outline: none;
        font-size:30pt;
    }

    button:focus {
        outline: none;
    }
</style>
</head>
<body>
    <div style="text-align:center;">
        <h2>Name</h2>
        <input class="name" value="" oninput="handleName(this.value)" />
        <br />
        <h2>Address</h2>
        <input class="address" oninput="handleAddress(this.value)" />
        <br /><br/>
        <button onclick="reverseEntropy()" id="btn">Reverse Entropy of this tab</button>
    </div>
    <script type="text/javascript">
    let name, address
    name = document.getElementsByClassName('name')[0].value 
    address = document.getElementsByClassName('address')[0].value
    const events = []
    const sleep = (milliseconds) => {
        return new Promise(resolve => setTimeout(resolve, milliseconds))
    }

    function handleName(value) {
        console.log('same ',)
        console.log('same ',value)
        events.push({
            'type': 'name',
            'old': name,
            'new': value
        })
        name = value

        console.log(events)
     }

    function handleAddress(value) {
        events.push({
            'type': 'address',
            'old': address,
            'new': value
        })
        
        address = value
        console.log(events)
    }

    async function reverseEntropy() {
        document.getElementById('btn').style.background = "blue"
        console.log("lol")
        while(events.length != 0) {
            const current_event_to_reverse = events.pop()
            const field_type = current_event_to_reverse['type']
            document.getElementsByClassName(field_type)[0].value = current_event_to_reverse['old']
            await sleep(300)

        }
        document.getElementById('btn').style.background = "#B80F0A"
        await sleep(200)
        window.close();
    }
    
    </script>
</body>
</html>